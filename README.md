Это API-сервис для управления пользователями, построенный на FastAPI, Poetry и ClickHouse.
Проект включает аутентификацию по API-ключу, валидацию данных, пагинацию, поиск и асинхронную (симуляцию) генерацию документов.

## Основные фичи

* **FastAPI**: Современный веб-фреймворк.
* **Poetry**: Управление зависимостями.
* **ClickHouse**: В качестве базы данных (OLAP).
* **Docker & Docker-Compose**: Для контейнеризации и простого запуска.
* **Архитектура**: Разделение логики на `repository`, `services`, `api`.
* **CRUD с пагинацией**: Полное управление пользователями.
* **Генерация документов**: Синхронные и асинхронные эндпоинты (`pdf`, `docx`).
* **Логирование**: Настроенный модуль `logging`.

## Запуск проекта

Есть два способа запустить проект: через Docker (рекомендуемый) или локально с Poetry.

### 1. Запуск через Docker (Рекомендуемый)

Этот способ автоматически поднимет и приложение, и базу данных ClickHouse.

1.  **Настройка `.env`:**
    Скопируй `.env.example` (если есть) или создай `.env` файл. Убедись, что `CLICKHOUSE_HOST` установлен в `clickhouse` (имя сервиса из `docker-compose.yml`).
    ```ini
    API_KEY="your_secret_key"
    CLICKHOUSE_HOST="clickhouse"
    CLICKHOUSE_PORT=8123
    ```

2.  **Сборка и запуск:**
    ```bash
    docker-compose up --build
    ```

3.  Приложение будет доступно по `http://127.0.0.1:8000`.

### 2. Запуск локально (Poetry)

Этот способ требует, чтобы у тебя **уже был запущен ClickHouse** где-то (например, через `docker run`).

1.  **Установка зависимостей:**
    ```bash
    poetry install
    ```

2.  **Настройка `.env`:**
    Убедись, что `CLICKHOUSE_HOST` указывает на твой локальный ClickHouse (например, `localhost`).
    ```ini
    API_KEY="your_secret_key"
    CLICKHOUSE_HOST="localhost"
    CLICKHOUSE_PORT=8123
    ```

3.  **Запуск сервера:**
    ```bash
    poetry run uvicorn app.main:app --reload
    ```

---

## API Эндпоинты

Вся документация доступна по `http://127.0.0.1:8000/docs`.

### Users (`/users`)
* `POST /`: Создать пользователя.
* `GET /`: Получить список пользователей (с пагинацией `skip`, `limit`).
* `GET /search/`: Поиск (параметр `q`).
* `GET /{user_id}`: Получить пользователя по ID.
*  и т.д.

### Documents (`/documents`)
* `POST /generate/sync`: Синхронная генерация.
* `POST /generate/async`: Асинхронная генерация с `callback_url`.